# AADSTS100007: Microsoft Entra Regional ONLY supports auth either for MSIs OR for requests from MSAL using SN+I for 1P apps or 3P apps in Microsoft infrastructure tenants.


## Troubleshooting Steps
### Troubleshooting guide for error code AADSTS100007

#### Initial Diagnostic Steps:
1. **Confirm Environment**: Verify if the error occurs specifically in the Microsoft Entra Regional environment and if it is related to authentication either for Managed Service Identifiers (MSIs) or requests from Microsoft Authentication Libraries (MSAL).

2. **Check Application Type**: Identify if the application is a 1P (First Party) or 3P (Third Party) app within Microsoft infrastructure tenants.

3. **Review Authentication Flow**: Examine how the application is attempting to authenticate and ensure it aligns with the guidance for Microsoft Entra Regional.

#### Common Issues:
- Incorrect authentication method being used for the application type.
- Improper configuration settings in the application for Microsoft Entra Regional.
- Misaligned permissions or scopes in the access token request.

#### Step-by-Step Resolution Strategies:
1. **Update Authentication Method**:
    - For MSIs: Ensure that the application is configured to use MSI for authentication.
    - For MSAL requests: Use SN+I (Service Principal Name and Instance) for 1P or 3P apps in Microsoft infrastructure tenants.

2. **Verify Application Configuration**:
    - Check the application's settings in Azure AD to ensure it is correctly configured for Microsoft Entra Regional.
    - Confirm that the permissions requested align with the guidelines for the environment.

3. **Review Code Implementation**:
    - Double-check the code implementing the authentication flow to ensure it follows the recommended approach for the given environment.
    - Update the code if necessary to comply with the requirements.

4. **Test and Debug**:
    - Test the application after making the changes and monitor for any errors or warnings.
    - Use debugging tools to inspect the requests and responses to identify any potential issues.

#### Additional Notes or Considerations:
- It's important to understand the specific requirements and limitations of the Microsoft Entra Regional environment for authentication.
- Ensure that all necessary permissions and configurations are in place before testing the application again.

#### Documentation for Guidance:
- [Azure Active Directory error codes & solutions](https://docs.microsoft.com/en-us/azure/active-directory/develop/reference-aadsts-error-codes)
- [Microsoft Identity standards](https://learn.microsoft.com/en-us/azure/active-directory/develop/authentication-understand-protocols)

By following these troubleshooting steps and guidance, you should be able to resolve the error code AADSTS100007 related to Microsoft Entra Regional authentication issues.