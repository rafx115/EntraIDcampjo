# AADSTS500212: NotAllowedByOutboundPolicyTenant - The user's administrator has set an outbound access policy that doesn't allow access to the resource tenant.


## Troubleshooting Steps
### Troubleshooting Guide for AADSTS500212 - NotAllowedByOutboundPolicyTenant

#### Overview
The error code AADSTS500212 occurs when a user attempts to access a resource in a different Azure Active Directory (Azure AD) tenant, but an outbound access policy prevents the action. This error is typically encountered in multi-tenant applications or organizations that have implemented strict access policies.

### Initial Diagnostic Steps

1. **Identify the User's Tenant and Resource Tenant:**
   - Determine which Azure AD tenant the user belongs to and which resource tenant they are trying to access.

2. **Collect User Information:**
   - Obtain the user's UPN (User Principal Name) and any relevant details about the resource they are trying to access.

3. **Review Access Policies:**
   - Check if the user has recently been assigned new roles or if there have been changes in outbound access policies at the tenant level.

4. **Check for Global vs. Conditional Access Policies:**
   - Assess if the issue is related to conditional access policies in place for the organization.

### Common Issues That Cause This Error

1. **Outbound Access Policy Restrictions:**
   - The most common reason is that the sandbox or outbound access policy set by the tenant administrator does not allow users from that tenant to access resources in a different tenant.

2. **Role Assignments:**
   - The user might lack the necessary permissions or roles that enable access to the resource.

3. **Tenancy Configurations:**
   - The configuration settings within Azure AD might be set to restrict certain applications or user types from accessing external tenants.

### Step-by-Step Resolution Strategies

1. **Check Outbound Access Policies:**
   - **Navigate to Azure Portal:**
     - Go to **Azure Active Directory** > **Enterprise applications** > **User settings**.
     - Review the **Outbound Access Policies** for the specific application involved.

2. **Modify Policies if Permissible:**
   - If you have administrative access:
     - Consider updating or creating a new outbound access policy to allow the necessary users or applications.
     - Ensure the policy allows outbound access to the destination tenant.

3. **Role Verification and Assignment:**
   - Verify the user's roles within the Azure AD tenant:
     - Go to **Azure Active Directory** > **Users** > (Select User) > **Assigned Roles** and confirm they have the needed roles.
   - If needed, assign additional roles or permissions.

4. **External Access Configuration:**
   - Check the **External collaboration settings** under **Azure Active Directory** > **External Identities** > **External collaboration settings**.
   - Verify and adjust settings to permit cross-tenant access if required.

5. **Test Access:**
   - After making changes, have the user attempt to access the resource again to see if the issue persists.

### Additional Notes or Considerations

- **Documentation Updates:**
  - Keep in mind that Azure AD policies and functionalities may change. Always refer to the latest Azure documentation for up-to-date instructions.
  
- **User Awareness:**
  - Inform users about the policies in place which may limit access, helping them understand why certain actions may result in this error.

### Documentation for Guidance

- [Microsoft Docs - Overview of Azure AD Conditional Access](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/overview)
- [Microsoft Docs - Configure Azure AD outbound access policies](https://docs.microsoft.com/en-us/azure/active-directory/external-identities/azure-ad-b2b-outbound-access-policies)
- [Microsoft Docs - Access an Azure Active Directory resource from an external tenant](https://docs.microsoft.com/en-us/azure/active-directory/external-identities/guest-access)

**Note**: Ensure that the links above are accessible for users by testing the documentation links directly.

### Advice for Data Collection

- **Error Logs**: Capture detailed error logs when the user attempts to access the resource.
- **User Context**: Gather information about the userï¿½s context, including group memberships, role assignments, and any recent activities that could affect access.
- **Access Policy Reports**: Review and export outbound access policy reports if available, to analyze configurations and history.
- **Support Tickets**: If the above steps do not resolve the issue, consider opening a ticket with Microsoft Support, providing them with all collected data.

By following this guide, you should be able to effectively troubleshoot and resolve the AADSTS500212 error code regarding outbound access policies in Azure Active Directory.