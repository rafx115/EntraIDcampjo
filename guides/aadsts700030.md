
# AADSTS700030: Invalid certificate - subject name in certificate isn't authorized. SubjectNames/SubjectAlternativeNames (up to 10) in token certificate are: {certificateSubjects}.


## Introduction

This guide will help resolve issues related to invalid certificate - subject

name in certificate isn't authorized. subjectnames/subjectalternativenames (up
to 10) in token certificate are: {certificatesubjects}..


## Prerequisites


* Access to the Azure AD portal with administrator privileges.

* The user must have already set up MFA.


## Steps to Resolve


### Step 1: Initial Actions

1. Log in to the Azure AD portal.
2. Navigate to the "Users" section.
3. Select the affected user.
4. Perform necessary actions as described for the error.


### Step 2: Verify MFA Settings

1. Ensure that the user has MFA configured.
2. If necessary, guide the user through the MFA setup process.


## Troubleshooting


* Check for any Azure AD conditional access policies that might be affecting the

  MFA process.

* Consider any additional security measures that might be in place.


## Additional Notes


* Refer to the

  [Azure AD 
documentation](https://learn.microsoft.com/en-us/azure/active-directory/)
  for more details.


## Troubleshooting Steps

Troubleshooting steps could not be generated due to an error.


## Troubleshooting Steps

Troubleshooting steps could not be generated due to an error.


## Troubleshooting Steps

Diagnosing and resolving the error code AADSTS700030 related to an invalid
certificate with the description "Invalid certificate - subject name in

certificate isn't authorized. SubjectNames/SubjectAlternativeNames (up to 10) in
token certificate are: {certificateSubjects}." can be tackled systematically by
following this detailed troubleshooting guide:


### Initial Diagnostic Steps:

1. **Check Certificate Configuration**: Verify the subject names and alternative
   names on the certificate used for authentication.
2. **Review Application Configuration**: Ensure the application settings are
   correctly configured with the appropriate certificate.


### Common Issues:


* **Mismatched Subject Names**: The subject name on the certificate does not

  match the expected subject name in the Azure Active Directory (AAD).

* **Expired or Revoked Certificate**: The certificate used for authentication

  has expired or been revoked.

* **Incorrect Certificate Installation**: The certificate is not correctly

  installed or configured on the application server.


### Step-by-step Resolution Strategies:

1. **Revalidate Certificate Configuration**:

   * Confirm that the subject name and alternative names on the certificate

     match the authorized settings in Azure AD.
   * Make sure the certificate is not expired or revoked.

2. **Update Application Configuration**:

   * Check the application settings to ensure they are using the correct

     certificate for authentication.
   * Update the application to use a valid certificate or update the certificate

     subject names if needed.

3. **Check Trust Relationships**:

   * Verify that the certificate issuer is trusted by Azure AD.

   * Review any intermediate certificate authorities required for the chain of

     trust.

4. **Generate and Install a New Certificate**:

   * If necessary, generate a new certificate with the correct subject name and

     alternative names.
   * Install the new certificate on the application server.

5. **Update Azure AD Configuration**:
   * Update the Azure AD application registration with the new certificate

     information, if applicable.
   * Ensure the Azure AD settings align with the updated certificate details.


### Additional Notes or Considerations:


* **Testing in a Sandbox Environment**: It's advisable to test any changes or

  updates in a sandbox environment before deploying them to production.

* **Logging and Monitoring**: Implement logging to track certificate-related

  issues and monitor certificate expiration dates to prevent such errors in the
  future.

* **Regular Certificate Maintenance**: Regularly review and update certificates

  used for authentication to avoid issues related to expiration or
  authorization.

By following these troubleshooting steps, you can effectively diagnose and
resolve the error code AADSTS700030 associated with an invalid certificate due
to unauthorized subject names.