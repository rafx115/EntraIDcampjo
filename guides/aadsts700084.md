# AADSTS700084: The refresh token was issued to a single page app (SPA), and therefore has a fixed, limited lifetime of {time}, which can't be extended. It is now expired and a new sign in request must be sent by the SPA to the sign in page. The token was issued on {issueDate}.


## Troubleshooting Steps
### Troubleshooting Guide for AADSTS700084 Error Code

#### Initial Diagnostic Steps:
1. Confirm the specific time limit for the refresh token lifetime in your application.
2. Verify the date the refresh token was issued ({issueDate} in the error message).
3. Ensure the application is correctly configured to handle refresh token expiration for single page apps.

#### Common Issues:
1. Incorrect handling of token expiration in the application code.
2. Application not properly requesting a new token after the refresh token expiration.
3. Misconfiguration of token settings in the authentication provider.
4. Network connectivity issues preventing the application from sending sign-in requests.

#### Step-by-Step Resolution Strategies:
1. **Update Token Handling in the Application:**
   - Modify the application code to recognize when a refresh token has expired and trigger a new sign-in request from the SPA.
2. **Request a New Token:**
   - Implement logic in the application to request a new token when the refresh token expires based on the fixed lifetime limitation.
3. **Check Authentication Provider Settings:**
   - Ensure that the authentication provider's configuration matches the requirements for handling token lifetimes in single page apps.
4. **Verify Network Connectivity:**
   - Confirm that the networking environment is not blocking the application from sending sign-in requests to the authentication provider.

#### Additional Notes or Considerations:
- It's important to handle token expiration gracefully in the application to avoid disruption in user experience.
- Make sure to inform users about the need to sign in again when their refresh token expires.
- Regularly review and update token management practices to ensure compliance with security best practices.

#### Documentation:
- Microsoft Authentication Library (MSAL) Documentation: [MSAL JavaScript Guide](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-library-for-js)
- Azure Active Directory Documentation: [Manage refresh tokens in Azure AD](https://docs.microsoft.com/en-us/azure/active-directory/develop/refresh-tokens)
- Microsoft Identity Platform Documentation: [Token Lifetimes in Azure AD](https://docs.microsoft.com/en-us/azure/active-directory/develop/access-tokens#token-lifetimes)

By following these steps and guidelines, you should be able to troubleshoot and resolve the AADSTS700084 error related to refresh token expiration in single page apps effectively.