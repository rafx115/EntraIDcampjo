
# AADSTS130006: NgcTransportKeyNotFound - The NGC transport key isn't configured on the device.


## Troubleshooting Steps
Certainly! Below is a detailed troubleshooting guide for the error code **AADSTS130006** with the description **NgcTransportKeyNotFound - The NGC transport key isn't configured on the device**.

## Troubleshooting Guide for AADSTS130006

### Initial Diagnostic Steps
1. **Identify the scenario**: Determine which application or service is throwing the error. This could be during a login attempt to Azure Active Directory (AAD) or when trying to access resources that require Windows Hello for Business.
   
2. **Check device configuration**: Ensure that the device is configured for Windows Hello for Business and that it meets all prerequisite configurations.

3. **Confirm user account information**: Verify that the user account is properly set up in AAD and that it is not locked or disabled.
   
4. **Review Event Viewer logs**: Check the Windows Event Viewer for any related logs that might provide more context about the error.

### Common Issues that Cause This Error
1. **Device not registered**: The device may not be registered with Azure Active Directory (AAD), which can lead to the inability to find the NGC (Next Generation Credentials) transport key.
  
2. **Windows Hello for Business is not configured**: If Windows Hello is not set up correctly on the device, the transport key will not be available.
   
3. **Corrupted or misconfigured local security policy**: Improper local policies or group policies could lead to issues in managing credentials.

4. **Encryption issues**: Misconfigurations in device encryption can hinder the ability to fetch the NGC transport key.

### Step-by-step Resolution Strategies
1. **Check Windows Hello for Business Configuration**:
   - Ensure that Windows Hello for Business is configured correctly.
   - Use the following documentation for guidance:
     - [Deploy Windows Hello for Business](https://docs.microsoft.com/en-us/windows/security/identity-protection/hello-for-business/hello-overview)
   
2. **Re-register the device with Azure AD**:
   - Go to **Settings > Accounts > Access work or school**.
   - Remove the work or school account.
   - Reconnect the account and ensure that the device is registered correctly.

3. **Verify Group Policy Settings**:
   - Run `gpedit.msc` to open Group Policy Editor.
   - Navigate to **Computer Configuration > Administrative Templates > Windows Components > Windows Hello for Business**.
   - Ensure that policies related to Windows Hello are configured correctly.
   - Check for any policies that might block access to NGC keys.

4. **Reset or Re-enable Windows Hello**:
   - Go to **Settings > Accounts > Sign-in options**.
   - If Windows Hello is set up, remove it, restart the device, and then re-enable it.
   - Follow the setup prompts to configure Windows Hello again.

5. **Check System Encryption Settings**:
   - Ensure that the device has BitLocker enabled if required. 
   - To enable BitLocker, go to **Control Panel > System and Security > BitLocker Drive Encryption**.

6. **Verify Trusted Platform Module (TPM) Status**:
   - Open TPM Management by running `tpm.msc`.
   - Ensure that the TPM is enabled and functioning.
   - If not, you may need to clear the TPM or take appropriate steps to get it working again.

### Additional Notes or Considerations
- Make sure Windows is up to date, as updates can resolve underlying compatibility or dependency issues.
- Consider the possibility of differences between local accounts and AAD accounts. Problems with local configurations can affect AAD integrations.
  
### Documentation for Guidance
- [Windows Hello for Business Overview](https://docs.microsoft.com/en-us/windows/security/identity-protection/hello-for-business/hello-overview)
- [Troubleshoot Windows Hello for Business](https://docs.microsoft.com/en-us/windows/security/identity-protection/hello-for-business/hello-troubleshoot)

### Test Documentation Accessibility
- Ensure that the provided links are available by attempting to access them through your web browser. The links should lead to the official Microsoft documentation pages.

### Advice for Data Collection
- Before making changes, document the current settings and policies related to Windows Hello and Azure Active Directory on the device.
- Capture logs from the Event Viewer that indicate the issue.
- If possible, take screenshots of the current configuration settings, error messages, and any diagnostics run in the Event Viewer for reference.

By following this guide, you should be able to diagnose and resolve the AADSTS130006 error effectively.