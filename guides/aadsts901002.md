
# AADSTS901002: AADSTS901002: The 'resource' request parameter isn't supported.


## Troubleshooting Steps
### Troubleshooting Guide for AADSTS901002: The 'resource' request parameter isn't supported.

The AADSTS901002 error indicates that the Azure Active Directory (AAD) service is not recognizing the 'resource' request parameter in your authentication request. This is often due to misconfiguration or using outdated patterns in your app's authentication flow. Hereâ€™s how to diagnose and resolve the issue.

#### Initial Diagnostic Steps

1. **Verify Environment**: Determine if the issue occurs in a development, testing, or production environment. This helps to understand if it's an isolated issue or systemic.

2. **Log Analysis**: Check application logs to capture the context in which the error occurred. Look for any details about the authentication request being made.

3. **Inspect Request Parameters**: Use a tool like Fiddler, Postman, or browser developer tools to inspect the full request being sent to the Azure AD endpoint. Take note of the parameters being sent, especially the 'resource' parameter.

#### Common Issues That Cause This Error

1. **Outdated Code**: Applications that were built with older Azure AD authentication models (like using the 'resource' parameter) may not be supported anymore. Microsoft has shifted to using the 'scope' parameter instead.

2. **Incorrect Request URL**: The endpoint or URL being used for the authorization request might not be correct.

3. **Misconfigured Azure AD Application**: The Azure AD application might not allow the requested resource or has not been set up correctly in the Azure portal.

4. **Wrong Authentication Flow**: You may be using a flow that does not support specifying a resource, such as the OAuth 2.0 authorization code flow for certain APIs.

#### Step-by-Step Resolution Strategies

1. **Update Authentication Code**:
   - Replace the use of the 'resource' parameter with the 'scope' parameter, aligning with the current OAuth 2.0 standards used by Azure AD.
   - Example:
     - Old: `&resource=https://graph.microsoft.com/`
     - New: `&scope=https://graph.microsoft.com/.default`
  
2. **Check the Application Registration**:
   - Go to the Azure portal:
     - Navigate to **Azure Active Directory** > **App registrations**.
     - Select your application.
     - Under **API permissions**, ensure the correct permissions are granted for the APIs you are trying to access.

3. **Test Endpoint Invocation**:
   - After updating your application, test the authentication flow again to see if the error persists.

4. **Use Developer Tools**:
   - Utilize tools to monitor network requests and responses to ensure parameters are correctly formed and sent.

5. **Refer to Azure Documentation**:
   - Follow the connection or API tutorials in Azure's documentation to ensure you are implementing the best practices.

#### Additional Notes or Considerations

- Ensure that all libraries and SDKs you are using (like MSAL, ADAL) are up to date, as older versions may reference deprecated practices.
- Confirm that you are adhering to the latest security practices in handling tokens and authentication flows.

#### Documentation for Guidance

- [Microsoft Identity Platform Documentation](https://docs.microsoft.com/en-us/azure/active-directory/develop/)
- [Azure AD Authentication Overview](https://docs.microsoft.com/en-us/azure/active-directory/develop/authentication-scenarios)
- [Use the v2.0 endpoint](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-overview)

#### Test Document Reachability

- You can check the links above in a browser to ensure they are accessible.

#### Advice for Data Collection

1. **Collect Logs**: Keep logs of authentication requests and responses, including timestamps and any error codes you encounter.
2. **Environment Variables**: Record details about your environment, such as the technology stack, libraries used, and version numbers.
3. **Replication Steps**: Document steps to replicate the issue for better troubleshooting by others or support teams.

By following these steps, you should be able to diagnose and resolve the AADSTS901002 error effectively. If issues persist after following this guide, consider reaching out to Azure support for further assistance.