
# AADSTS500133: Assertion isn't within its valid time range. Ensure that the access token isn't expired before using it for user assertion, or request a new token. Current time: {curTime}, expiry time of assertion {expTime}. Assertion is invalid because of various reasons:The token issuer doesn't match the API version within its valid time rangeExpiredMalformedRefresh token in the assertion isn't a primary refresh token


## Introduction

This guide will help resolve issues related to assertion isn't within its valid
time range. ensure that the access token isn't expired before using it for user
assertion, or request a new token. current time: {curtime}, expiry time of
assertion {exptime}. assertion is invalid because of various reasons:the token
issuer doesn't match the api version within its valid time
rangeexpiredmalformedrefresh token in the assertion isn't a primary refresh
token.


## Prerequisites


* Access to the Azure AD portal with administrator privileges.

* The user must have already set up MFA.


## Steps to Resolve


### Step 1: Initial Actions

1. Log in to the Azure AD portal.
2. Navigate to the "Users" section.
3. Select the affected user.
4. Perform necessary actions as described for the error.


### Step 2: Verify MFA Settings

1. Ensure that the user has MFA configured.
2. If necessary, guide the user through the MFA setup process.


## Troubleshooting


* Check for any Azure AD conditional access policies that might be affecting the

  MFA process.

* Consider any additional security measures that might be in place.


## Additional Notes


* Refer to the

  [Azure AD 
documentation](https://learn.microsoft.com/en-us/azure/active-directory/)
  for more details.


## Troubleshooting Steps

Troubleshooting steps could not be generated due to an error.


## Troubleshooting Steps

Troubleshooting steps could not be generated due to an error.


## Troubleshooting Steps


### Troubleshooting Guide for Error Code AADSTS500133


#### Initial Diagnostic Steps:

1. Verify the current time ({curTime}) and the expiry time of the assertion
   ({expTime}).
2. Check if the access token used for user assertion has expired.
3. Review the token issuer and confirm if it matches the API version.
4. Ensure the refresh token in the assertion is a primary refresh token.


#### Common Issues causing AADSTS500133:

1. Expired access token: The access token used for user assertion may be
   expired.
2. Mismatched token issuer: The token issuer does not match the API version
   within its valid time range.
3. Malformed refresh token: The refresh token in the assertion is not a primary
   refresh token.


#### Step-by-Step Resolution Strategies:

1. Request a new access token: If the access token has expired, request a new
   access token before using it for user assertion.
2. Verify token issuer: Confirm that the token issuer matches the API version
   within its valid time range.
3. Use primary refresh token: Ensure that the refresh token in the assertion is
   a primary refresh token.


#### Additional Notes or Considerations:


* Always validate the tokens and assertions before using them in your

  application.

* Keep track of token expiration times and ensure timely renewal.

* Check for any recent changes in token issuance or API versions that might have

  caused the error.

By following these troubleshooting steps and considering the common causes
outlined above, you should be able to resolve the Assertion isn't within its
valid time range error with the AADSTS500133 error code effectively. If the
issue persists, consider reaching out to your identity provider or system
administrator for further assistance.