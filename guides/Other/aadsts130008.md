# AADSTS130008: NgcDeviceIsNotFound - The device referenced by the NGC key wasn't found.


## Troubleshooting Steps
Here's a troubleshooting guide for the AADSTS130008 error code, specifically when you encounter the "NgcDeviceIsNotFound" description.

### AADSTS130008 Troubleshooting Guide

#### Initial Diagnostic Steps
1. **Understand the Context**: Identify when the error occurs. Is it during authentication to an application, a website, or a specific service?
2. **Check the Error Message**: Verify that the error message is indeed AADSTS130008 and not another related error message.
3. **Verify User Account**: Ensure you are using the correct account and that it has the necessary permissions for the application or service you are accessing.
4. **Examine Device Configuration**: Determine if the device you're attempting to authenticate with is correctly set up and compatible with NGC authentication policies.

#### Common Issues that Cause This Error
1. **Device Not Registered**: The device might not be properly registered with Azure AD or the required NGC key is missing.
2. **Non-compliance**: The device may not meet the requirements for NGC, such as requiring a supported operating system version or specific configurations.
3. **Corrupted Certificates**: Issues with the user certificate or NGC key may lead to this error.
4. **Expired Credentials**: User credentials or tokens have expired, leading to an inability to find the NGC key.
5. **Software Issues**: There might be bugs in the authentication client or the operating system affecting the NGC process.

#### Step-by-Step Resolution Strategies
1. **Check Device Registration**:
   - Go to Azure AD portal.
   - Navigate to the "Devices" section.
   - Ensure that your device is listed. If itÂ’s not listed, you need to register it.

2. **Re-register the Device**:
   - On your device, go to **Settings** > **Accounts** > **Access work or school**.
   - Disconnect from the organization and then reconnect, which should prompt re-registration.

3. **Update the Operating System**:
   - Ensure your operating system is fully updated. Check for updates:
     - Windows: Settings > Update & Security > Windows Update.
     - Mac: System Preferences > Software Update.
   - Restart your device to apply updates.

4. **Check for Software Configuration**:
   - Ensure that the device is set up for NGC. For Windows, this typically means enabling the Windows Hello feature.
   - Go to **Settings** > **Accounts** > **Sign-in options** and ensure Windows Hello is configured.

5. **Repair Certificates**:
   - Open PowerShell as an Administrator.
   - Use the command: `Get-ChildItem -Path Cert:\CurrentUser\My | Where-Object { $_.Subject -like "*<username>*" } | Format-List`.
   - If certificates are missing or corrupted, re-establish your credentials (which may require re-enrollment).

6. **Clear Cached Credentials**:
   - Open Credential Manager (Control Panel > User Accounts > Credential Manager).
   - Remove any cached credentials related to the service you are attempting to access.
   - Restart and attempt to login again.

7. **Reset NGC Key**:
   - From Command Prompt (admin), use: `dsregcmd /leave` followed by `dsregcmd /join` to reset the device registration with Azure AD.

#### Additional Notes or Considerations
- If the problem persists, consider whether there are group policies or security settings in your organization that may be affecting NGC or device registration.
- Check if there are any ongoing outages or issues with Azure services that might affect authentication.
- Review the logs on the device in Event Viewer to find more detailed error messages or clues.

#### Documentation for Guidance
- Official Microsoft documentation can be found at:
  - [Azure AD Device Registration](https://docs.microsoft.com/en-us/azure/active-directory/devices/deviceregister)
  - [Windows Hello for Business](https://docs.microsoft.com/en-us/windows/security/identity-protection/hello-for-business/hello-overview)
  
#### Testing Documentation Accessibility
- To ensure the documentation is reachable, you can click the links provided above or simply search for "Azure AD Device Registration" or "Windows Hello for Business" in Microsoft Docs.

#### Advice for Data Collection
- Collect logs from the following sources:
  - Event Viewer: Look for relevant logs under Applications and Services Logs > Microsoft > Windows > User Device Registration.
  - Azure Mobile Apps Authentication Logs or Azure AD Sign-In Logs.
  - Any relevant logs from the authentication client or application attempting to use NGC.
- Gather information about the environment:
  - OS version, device model, Azure AD tenant settings, and any recent changes to account access or device management.

Using this guide should help in diagnosing and resolving the AADSTS130008 NgcDeviceIsNotFound error effectively.

Category: Other