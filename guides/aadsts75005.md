
# AADSTS75005: Saml2MessageInvalid - Microsoft Entra doesn’t support the SAML request sent by the app for SSO. To learn more, see the troubleshooting article for errorAADSTS75005.


## Troubleshooting Steps
### Troubleshooting Guide for Error Code AADSTS75005: Saml2MessageInvalid

Error Code: **AADSTS75005**  
Error Message: **Saml2MessageInvalid - Microsoft Entra doesn’t support the SAML request sent by the app for SSO.**

This error indicates that there is an issue with the SAML authentication request generated by the application trying to perform Single Sign-On (SSO) with Microsoft Entra (formerly Azure Active Directory).

---

### 1. Initial Diagnostic Steps

1. **Understand the Context**: Gather information about what triggered the error. For instance, was the error encountered during a login attempt? Specifying whether this occurs for specific users or across the board can help narrow down the issues.
  
2. **Check the Exact Error Returned**: Ensure that the error message includes sufficient detail. Look for any additional error codes or messages that may provide more context.

3. **Reproduce the Error**: Try to replicate the issue to see if it is consistent or intermittent. Document the steps taken to reproduce it.

4. **Review Application Logs**: Check the application logs to identify the exact SAML request sent to Microsoft Entra.

### 2. Common Issues that Cause This Error

1. **Incorrectly Configured SAML Request**: The SAML request might not adhere to the expected format that Microsoft Entra supports.

2. **Invalid or Expired Assertion**: The SAML assertion included in the request might be invalid or expired.

3. **Unsupported Signature Algorithms**: The signature algorithm used in the SAML request may not be supported by Microsoft Entra.

4. **Certificate Issues**: The certificate used to sign the SAML request may not be correctly configured or may be expired.

5. **SP Metadata Issues**: There may be issues with the Service Provider (SP) metadata settings in Microsoft Entra including the entity ID and reply URLs.

6. **Clock Skew**: There can be time discrepancies between the Identity Provider (IdP) and the Service Provider (SP) leading to invalid assertions.

### 3. Step-by-Step Resolution Strategies

#### Step 1: Verify SAML Request

- Examine the SAML request being sent by the application. It can often be found in the browser's developer tools or in application logs.
- Ensure that it conforms to the SAML 2.0 protocol specifications.

#### Step 2: Confirm Configuration in Microsoft Entra

- Log in to the Microsoft Entra admin portal.
- Navigate to **Enterprise applications** and select the application in question.
- Check the **Single sign-on** configuration to verify:
  - Entity ID
  - Reply URL (also known as Assertion Consumer Service URL)
  - Signing certificate

#### Step 3: Check the Signature

- Confirm that the signing certificate used by the application has not expired and matches the one configured in Microsoft Entra.
- Ensure that the correct signature algorithm is being used that is supported by Entra (e.g., SHA256).

#### Step 4: Validate Assertion Settings

- If an assertion is generated during the SSO process, check its validity including:
  - NotBefore and NotOnOrAfter attributes to avoid expiry.
  - Audience URIs should match the app's identifier (Entity ID).
  
#### Step 5: Test Clock Synchronization

- Ensure both the service provider and identity provider systems have synchronized clocks. Utilize protocols like NTP (Network Time Protocol) if necessary.

### 4. Additional Notes or Considerations

- Ensure that the application and Microsoft Entra are updated to the latest versions.
- Evaluate if there have been any recent changes to either the SSO configuration or the underlying systems that may have affected the integration.

### 5. Documentation for Guidance

- **SAML Configuration for Microsoft Entra**: [Microsoft Docs: Configure SAML-based single sign-on](https://learn.microsoft.com/en-us/azure/active-directory/develop/active-directory-saml-protocol)
- **Understanding SAML Assertions**: [SAML 2.0 Technical Overview](https://www.oasis-open.org/standards#samlv2.0)
  
**Check Documentation**: Ensure you can access the above links. You should see the intended guides. If unable to access, consider checking alternate ways such as community forums or Microsoft support channels.

### 6. Advice for Data Collection

- When troubleshooting, collect the following data:
  - The SAML request XML (if possible).
  - The specific configuration settings used in both the SP and IdP.
  - Logs from both the application and Microsoft Entra that correlate with the error occurrence.
  - Any relevant network data (if applicable) that can indicate where communication may be failing.

By following these steps and utilizing the resources outlined, you should be able to identify and resolve the AADSTS75005 error effectively.