# AADSTS1000104: XCB2BResourceCloudNotAllowedOnIdentityTenant - Resource cloud {resourceCloud} isn't allowed on identity tenant {identityTenant}. {resourceCloud} - cloud instance which owns the resource. {identityTenant} - is the tenant where signing-in identity is originated from.

## Introduction

This guide will help resolve issues related to
xcb2bresourcecloudnotallowedonidentitytenant - resource cloud {resourcecloud}
isn't allowed on identity tenant {identitytenant}. {resourcecloud} - cloud
instance which owns the resource. {identitytenant} - is the tenant where
signing-in identity is originated from..

## Prerequisites

* Access to the Azure AD portal with administrator privileges.
* The user must have already set up MFA.

## Steps to Resolve

### Step 1: Initial Actions

1. Log in to the Azure AD portal.
2. Navigate to the "Users" section.
3. Select the affected user.
4. Perform necessary actions as described for the error.

### Step 2: Verify MFA Settings

1. Ensure that the user has MFA configured.
2. If necessary, guide the user through the MFA setup process.

## Troubleshooting

* Check for any Azure AD conditional access policies that might be affecting the
  MFA process.
* Consider any additional security measures that might be in place.

## Additional Notes

* Refer to the
  [Azure AD documentation](https://learn.microsoft.com/en-us/azure/active-directory/)
  for more details.

## Troubleshooting Steps

Troubleshooting steps could not be generated due to an error.

## Troubleshooting Steps

Troubleshooting steps could not be generated due to an error.

## Troubleshooting Steps

**Troubleshooting Guide for Error Code AADSTS1000104:
XCB2BResourceCloudNotAllowedOnIdentityTenant**

**Initial Diagnostic Steps:**

1. **Validate the Resource Cloud and Identity Tenant:** Confirm the specific
   resource cloud and identity tenant involved in the error message. This
   information will help in understanding the context of the issue.

2. **Check User Sign-In Identity:** Identify the tenant from which the user is
   signing in and ensure that it aligns with the expected identity tenant.

3. **Review Access Policies:** Look into the access policies and permissions
   associated with the resource cloud and identity tenant to determine any
   misconfigurations.

**Common Issues:**

1. **Mismatched Tenants:** The error may occur if the resource cloud and the
   identity tenant are not supposed to be associated based on the application's
   configuration.

2. **Incorrect Permissions:** Users might lack the necessary permissions to
   access resources in the specified cloud instance from the originating
   identity tenant.

3. **Tenant Federation Errors:** Issues related to tenant federation
   configurations can sometimes cause interoperability problems between
   different cloud instances and identity tenants.

**Step-by-Step Resolution Strategies:**

1. **Verify Tenant Associations:**
   * Ensure that the resource cloud and identity tenant are logically
     interconnected or have the appropriate trust relationships established.

2. **Review Access Permissions:**

   * Validate that the user attempting to sign in has the required permissions
     within the resource cloud and that these permissions are correctly
     configured.

3. **Check Federation Settings:**

   * Examine the federation settings for both the resource cloud and identity
     tenant to confirm that they are compatible and configured correctly.

4. **Update Policies and Settings:**
   * Adjust the access policies, trust settings, or federation configurations as
     needed to allow the intended access between the identified tenants.

**Additional Notes or Considerations:**

* **Leverage Azure Active Directory (AAD) Tools:** Use AAD administration tools
  to audit configurations, permissions, and tenant associations for better
  insights.

* **Consult Application Documentation:** Refer to the application's
  documentation or contact the service provider for specific guidance on
  resolving this error within their platform.

* **Enable Logging and Monitoring:** Implement robust logging and monitoring
  practices to track access attempts and identify any recurring patterns related
  to this error.

By following these troubleshooting steps and strategies, you can effectively
address the AADSTS1000104 error code related to the
XCB2BResourceCloudNotAllowedOnIdentityTenant issue.
