
# AADSTS900384: JWT token failed signature validation. Actual message content is runtime specific, there are a variety of causes for this error. Please see the returned exception message for details.


## Introduction

This guide will help resolve issues related to jwt token failed signature
validation. actual message content is runtime specific, there are a variety of
causes for this error. please see the returned exception message for details..


## Prerequisites


* Access to the Azure AD portal with administrator privileges.

* The user must have already set up MFA.


## Steps to Resolve


### Step 1: Initial Actions

1. Log in to the Azure AD portal.
2. Navigate to the "Users" section.
3. Select the affected user.
4. Perform necessary actions as described for the error.


### Step 2: Verify MFA Settings

1. Ensure that the user has MFA configured.
2. If necessary, guide the user through the MFA setup process.


## Troubleshooting


* Check for any Azure AD conditional access policies that might be affecting the

  MFA process.

* Consider any additional security measures that might be in place.


## Additional Notes


* Refer to the

  [Azure AD 
documentation](https://learn.microsoft.com/en-us/azure/active-directory/)
  for more details.


## Troubleshooting Steps

Troubleshooting steps could not be generated due to an error.


## Troubleshooting Steps

Troubleshooting steps could not be generated due to an error.


## Troubleshooting Steps

Here is a detailed troubleshooting guide for the error code AADSTS900384 - "JWT

token failed signature validation". This error typically occurs when there is an
issue with the validation of the JSON Web Token (JWT) signature. Below are the
steps to diagnose, common causes, resolution strategies, and additional notes to
consider:


### Initial Diagnostic Steps:

1. **Check the Exception Message:** The first step is to look at the specific

   exception message provided along with the error code. This message may
   contain details about the exact cause of the signature validation failure.

2. **Review Configuration:** Ensure that the JWT token generation and validation

   mechanisms are correctly implemented in the application code and that the
   correct keys are being used.

3. **Check Environment & Dependencies:** Verify that the application

   environment, libraries, and dependencies are properly configured and
   up-to-date.


### Common Issues:

Here are some common issues that can cause the AADSTS900384 error:

1. **Incorrect Key Configuration:** The keys used for signing and validating the

   JWT token may not match or might be outdated.

2. **Token Expiration:** The JWT token might have expired, causing its signature

   validation to fail.

3. **Algorithm Mismatch:** The algorithm used to sign the token might not match

   the one expected during validation.

4. **Data Tampering:** The token payload might have been tampered with, causing

   the signature to become invalid.


### Step-by-Step Resolution Strategies:

1. **Check Token Expiry:** Verify the expiry time of the token and ensure that

   it has not expired.

2. **Verify Key Configuration:** Make sure that the correct keys are being used

   for signing and validating the JWT token.

3. **Check Algorithm Matching:** Ensure that the algorithms used for token

   signing and validation match and are supported by the platform.

4. **Validate Token Payload:** Verify the integrity of the token payload to rule

   out any tampering that could invalidate the signature.

5. **Update Dependencies:** Update the libraries and dependencies related to JWT

   token processing to ensure compatibility and security.


### Additional Notes or Considerations:


* **Token Revocation:** Consider implementing a token revocation mechanism to

  invalidate compromised tokens.

* **Logging and Monitoring:** Add logging and monitoring to track token-related

  errors and debug any issues that arise.

* **Security Best Practices:** Follow security best practices for JWT token

  handling to prevent vulnerabilities and ensure secure authentication.

By following these steps, you should be able to diagnose and resolve the
AADSTS900384 error related to JWT token signature validation. If the issue
persists, consider seeking further assistance from Azure Active Directory
support or consulting the official documentation for specific guidance related
to your runtime environment.